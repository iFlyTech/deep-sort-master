"""
For training models.

Modified from https://pytorch.org/tutorials/intermediate/seq2seq_transl